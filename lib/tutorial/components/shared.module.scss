@import "definitions";

.genericIntroProse {
  strong {
    color: $blue;
  }
}

.notForCreditAlert {
  font-size: $text-small;
  background: $light-blue;
  border-radius: $border-radius;
  padding: 1rem;
  box-shadow: $box-shadow-border, $box-shadow-light;
  opacity: $opacity-faded;
}

////////////////////////////////////////////////////////////////////////////////
// Content.
////////////////////////////////////////////////////////////////////////////////

.tutorialMain {
  @media (min-width: rem-to-px($width-tutorial-sidebar + $width-content-2column) + 1px) {
    display: grid;
    grid-template-columns:
      $width-tutorial-sidebar minmax($width-content-2column, 1fr)
      minmax(0, $width-tutorial-sidebar);
  }

  @media (min-width: rem-to-px($width-tutorial-sidebar + $width-content) + 1px) and (max-width: rem-to-px($width-tutorial-sidebar + $width-content-2column)) {
    display: grid;
    grid-template-columns: $width-tutorial-sidebar 1fr;
  }

  @include below-sidebar-visible {
    padding-top: 3rem; // Space for he header
  }
}

.tutorialContent {
  counter-reset: section;

  @include above-sidebar-visible {
    grid-column: 2;
  }
}

.loggedOut {
  text-align: center;
  margin-top: calc(2rem + 10vh);
}

////////////////////////////////////////////////////////////////////////////////
// Sidebar & Nav.
////////////////////////////////////////////////////////////////////////////////

$padding-left-sidebar: 2.5rem; // For the hanging numbers in the list

.sidebar {
  position: fixed;
  z-index: $z-sidebar;
  left: 0;
  top: $height-header;
  bottom: 0;

  overflow-y: auto;
  overflow-x: hidden;
  -webkit-overflow-scrolling: touch;

  width: $width-tutorial-nav;
  padding-top: 1rem;
  padding-right: 1rem;
  padding-bottom: 5rem; // Room for the overlapping "Saved status"
  padding-left: $padding-left-sidebar;

  @include below-sidebar-visible {
    background: $bg-overlay;
    border-right: 1px solid $grey80;
    box-shadow: $box-shadow-overlay;

    transition: opacity $duration-active $easing,
      transform $duration-active $easing;
    will-change: opacity, transform;
    transform-origin: -50px -50px;
    transform: translateX(0);

    &:not(.toggled) {
      visibility: hidden;
      pointer-events: none;
      opacity: 0;
      transform: rotateY(-20deg) rotateX(-3deg);
    }
  }
}

.headerTitle {
  @include above-sidebar-visible {
    display: none;
  }

  position: fixed;
  z-index: $z-headerTitle;
  top: 0;
  left: 0;
  right: 0;
  height: $height-header;
  padding: 0.5rem ($width-header-button + 0.5rem);

  background: $bg-overlay;
  border-bottom: 1px solid $grey80;
  box-shadow: $box-shadow;

  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  text-align: center;
}

.otherTutorialsLink {
  display: flex;
  align-items: center;
  font-size: $text-small;
  opacity: $opacity-faded;

  $arrow-size: $text-normal;
  $arrow-margin: 0.4rem;

  &.otherTutorialsLinkFixed {
    @include below-sidebar-visible {
      display: none;
    }

    position: fixed;
    z-index: $z-otherTutorialsLink;
    top: 0;
    left: 0;
    height: $height-header;
    padding-top: 0.5rem;
    padding-bottom: 0.5rem;
    padding-left: 2.5rem - ($arrow-size + $arrow-margin);
    padding-right: 1rem;

    border-style: solid;
    border-color: $grey80;
    border-right-width: 1px;
    border-bottom-width: 1px;
    border-bottom-right-radius: $border-radius;
    background: $bg-overlay;
  }

  &.otherTutorialsLinkInline {
    @include above-sidebar-visible {
      display: none;
    }

    margin-bottom: 1rem;
    margin-left: -($arrow-size + $arrow-margin);
  }

  svg {
    display: block;
    fill: currentColor;
    width: $arrow-size;
    height: $arrow-size;
    margin-right: $arrow-margin;
    opacity: 0.5 / $opacity-faded;
  }

  &:hover {
    color: $blue;
    opacity: 1;

    svg {
      fill: $blue;
    }
  }
}

.sidebarToggle {
  @include above-sidebar-visible {
    display: none;
  }

  position: fixed;
  z-index: $z-sidebarToggle;
  top: 0;
  left: 0;
  width: $width-header-button;
  height: $height-header;
  padding: 0.5rem 1rem;

  border-style: solid;
  border-color: $grey80;
  border-right-width: 1px;
  border-bottom-width: 1px;
  background: $bg-overlay;

  display: flex;
  justify-content: center;
  align-items: center;

  transition: color $duration-hover $easing,
    border-bottom-color $duration-active $easing;

  svg {
    display: block;
    width: 1.5rem;
    height: 1.5rem;

    rect {
      fill: currentColor;
      rx: $border-radius;
    }
  }

  .ht,
  .hb {
    transition: opacity $duration-active $easing,
      transform $duration-active $easing;
  }

  .hm1,
  .hm2 {
    transition: transform $duration-active $easing;
    transform: translateX(0);
    transform-origin: center center;
  }

  &:hover {
    color: $blue;
  }

  &.toggled {
    color: $blue;
    border-bottom-color: #fff;

    .ht {
      opacity: 0;
      transform: translateY(33%);
    }

    .hb {
      opacity: 0;
      transform: translateY(-33%);
    }

    .hm1 {
      transform: rotateZ(45deg);
    }

    .hm2 {
      transform: rotateZ(-45deg);
    }
  }
}

.sidebarTutorialTitle {
  font-weight: $bold;
  opacity: $opacity-faded;
}

.tutorialParts {
  margin: 1rem 0 0;
  padding: 0;
  list-style: none;
  counter-reset: tutorial-parts-counter;
  font-size: $text-small;

  $counter-opacity: 0.5;

  @include above-sidebar-visible {
    // Hide the footer <hr>.  The window has to be pretty short for this to be
    // an actual problem.
    background: $bg-overlay;
  }

  li {
    position: relative;

    &:not(.skipCounter) {
      counter-increment: tutorial-parts-counter;
    }
  }

  li:not(.active) {
    &::before {
      position: absolute;
      opacity: $counter-opacity;
      pointer-events: none;
    }

    &.skipCounter::before {
      content: "";
      top: 0.45rem;
      right: calc(100% + 0.35rem);
      font-weight: $bold;
      display: block;
      width: $text-small;
      height: $text-small;
      background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' %3e%3ccircle stroke='%23333' stroke-width='1.5' r='3' cx='8' cy='8' fill='none' /%3e%3c/svg%3e");
    }

    &.skipCounter:hover::before {
      // This includes the $blue variable.
      background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' %3e%3ccircle stroke='%232684ff' stroke-width='1.5' r='3' cx='8' cy='8' fill='none' /%3e%3c/svg%3e");
    }
    &:not(.skipCounter)::before {
      content: counter(tutorial-parts-counter) ". ";
      right: 100%;
      padding-right: 0.4rem;
    }
  }

  li.active::before {
    content: "";
    display: block;
    position: absolute;
    width: $text-small;
    height: $text-small;
    right: calc(100% + 0.6rem);
    top: 0.4rem;
    opacity: $counter-opacity;
    background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' %3e%3cpath fill='%23333' fill-rule='evenodd' d='M8.22 2.97a.75.75 0 0 1 1.06 0l4.25 4.25a.75.75 0 0 1 0 1.06l-4.25 4.25a.75.75 0 0 1-1.06-1.06l2.97-2.97H3.75a.75.75 0 0 1 0-1.5h7.44L8.22 4.03a.75.75 0 0 1 0-1.06z'/%3e%3c/svg%3e");
  }

  li:not(.active):hover {
    color: $blue;
  }

  .part {
    display: block;
    // Space for the number, but overlap it so you can click on it too.
    padding-left: 2rem;
    margin-left: -2rem;
    opacity: $opacity-faded;
  }

  .active .part {
    opacity: 1;
  }
}

////////////////////////////////////////////////////////////////////////////////
// Saved status.
////////////////////////////////////////////////////////////////////////////////

.savedStatus {
  position: fixed;
  z-index: $z-savedStatus;
  left: 0;
  bottom: 0;
  border-top-right-radius: $border-radius;

  font-size: $text-small;
  background: $bg-overlay;
  color: rgba($text-color, 0.5);

  padding-top: 0.5rem;
  padding-bottom: 0.5rem;

  $svg-space: 0.4rem;
  @include above-sidebar-visible {
    padding-right: 1rem;
    padding-left: (2.5rem - $text-small - $svg-space);
  }

  @include below-sidebar-visible {
    padding: 0.5rem $padding-content;
  }

  svg {
    position: relative;
    top: -0.15rem;
    width: $text-small;
    height: $text-small;
    margin-right: $svg-space;
  }
}

.savedStatusError {
  color: red;
}
